<div class="h-screen flex items-center justify-center">
  <form
    [formGroup]="registerForm"
    (ngSubmit)="register()"
    class="shadow-md rounded-md p-5 bg-white w-full max-w-sm"
  >
    <!-- Backend validation errors -->
    <div
      *ngFor="let error of errors"
      class="bg-red-100 border border-red-300 text-red-700 p-2 mb-2 rounded"
    >
      <p class="text-xs">
        <strong>{{ error.code }}:</strong> {{ error.description }}
      </p>
    </div>

    <div class="py-4">
      <h1 class="font-bold text-xl text-left py-2">Register</h1>
      <p class="text-slate-600 text-base">Create your account</p>
    </div>

    <!-- Email -->
    <mat-form-field appearance="fill" class="w-full my-2">
      <mat-label>Email</mat-label>
      <mat-icon matPrefix>email</mat-icon>
      <input matInput formControlName="emailAddress" placeholder="Email" type="email" />
      <mat-error *ngIf="registerForm.get('emailAddress')?.hasError('required')">
        Email is required
      </mat-error>
      <mat-error *ngIf="registerForm.get('emailAddress')?.hasError('email')">
        Invalid email
      </mat-error>
    </mat-form-field>

    <!-- Full Name -->
    <mat-form-field appearance="fill" class="w-full my-2">
      <mat-label>Full Name</mat-label>
      <mat-icon matPrefix>person</mat-icon>
      <input matInput formControlName="fullName" placeholder="Full Name" type="text" />
      <mat-error *ngIf="registerForm.get('fullName')?.hasError('required')">
        Full name is required
      </mat-error>
    </mat-form-field>

    <!-- Role -->
    <mat-form-field appearance="fill" class="w-full my-2">
      <mat-label>Role</mat-label>
      <mat-icon matPrefix>groups</mat-icon>
      <mat-select formControlName="roles" multiple>
        <mat-option *ngFor="let item of roles$ | async" [value]="item.name">
          {{ item.name }}
        </mat-option>
      </mat-select>
      <mat-error *ngIf="registerForm.get('roles')?.hasError('required')">
        Role is required
      </mat-error>
    </mat-form-field>

    <!-- Password -->
    <mat-form-field appearance="fill" class="w-full my-2">
      <mat-label>Password</mat-label>
      <mat-icon matPrefix>lock</mat-icon>
      <input matInput formControlName="password" placeholder="Password" type="password" />
      <mat-error *ngIf="registerForm.get('password')?.hasError('required')">
        Password is required
      </mat-error>
    </mat-form-field>

    <!-- Confirm Password -->
    <mat-form-field appearance="fill" class="w-full my-2">
      <mat-label>Confirm Password</mat-label>
      <mat-icon matPrefix>lock</mat-icon>
      <input
        matInput
        formControlName="confirmPassword"
        [type]="confirmPasswordHide ? 'password' : 'text'"
        placeholder="Confirm Password"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        (click)="confirmPasswordHide = !confirmPasswordHide"
        class="cursor-pointer"
        aria-label="Toggle password visibility"
      >
        <mat-icon>{{ confirmPasswordHide ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-error *ngIf="registerForm.get('confirmPassword')?.hasError('required')">
        Confirm password is required
      </mat-error>
      <mat-error *ngIf="registerForm.hasError('passwordMismatch')">
        Passwords do not match
      </mat-error>
    </mat-form-field>

    <!-- Submit Button -->
    <button
      type="submit"
      [disabled]="registerForm.invalid"
      class="w-full mt-4 bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 rounded-md transition duration-300"
    >
      Register
    </button>

    <!-- Already have account -->
    <div class="my-4 text-center">
      <span class="text-slate-600">Already have an account?</span>
      <a [routerLink]="['/login']" class="text-purple-700 font-semibold ml-1">Login</a>
    </div>
  </form>
</div>
